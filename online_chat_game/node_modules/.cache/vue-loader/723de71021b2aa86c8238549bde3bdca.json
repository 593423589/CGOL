{"remainingRequest":"C:\\Users\\王有赫\\Documents\\my files\\vue\\CGOL\\online_chat_game\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\王有赫\\Documents\\my files\\vue\\CGOL\\online_chat_game\\src\\components\\personalInfor.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\王有赫\\Documents\\my files\\vue\\CGOL\\online_chat_game\\src\\components\\personalInfor.vue","mtime":1569214007419},{"path":"C:\\Users\\王有赫\\Documents\\my files\\vue\\CGOL\\online_chat_game\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\王有赫\\Documents\\my files\\vue\\CGOL\\online_chat_game\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\王有赫\\Documents\\my files\\vue\\CGOL\\online_chat_game\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\王有赫\\Documents\\my files\\vue\\CGOL\\online_chat_game\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n    name: \"personalInfor\",\n    data() {\n        return {\n            sexRadio: '',\n            name: '',\n            avatar: '',\n            avatarImg:'img/default_avatar/avatar.jpg',\n            avatarAction:'http://localhost:8888/uploadImg'\n        };\n    },\n    mounted() {\n        this.name = this.$parent.name //把个人信息填充进来\n        this.sexRadio = this.$parent.sex\n        this.avatarImg = this.$parent.avatar || 'img/default_avatar/avatar.jpg'\n    },\n    methods: {\n        handleAvatarSuccess(res, file) {\n            this.imageUrl = URL.createObjectURL(file.raw);\n            this.avatarImg = this.imageUrl\n            this.avatar = res\n        },\n        beforeAvatarUpload(file) {\n            const ImgType = ['image/jpeg', 'image/png', ' image/jpg'];\n            let isImg = ImgType.includes(file.type);\n            const isLt2M = file.size / 1024 / 1024 < 2;\n\n            if (!isImg) {\n                this.$message.error('上传头像图片只能是 jpg/png 格式!');\n            }\n            if (!isLt2M) {\n                this.$message.error('上传头像图片大小不能超过 2MB!');\n            }\n            return isImg && isLt2M;\n        },\n        commit() {\n            const config = {\n                headers: {'Content-Type': 'application/json'}\n            }\n            const api = this.$parent.api\n            if (this.name === '' || this.sexRadio === '') {\n                this.$message.error('信息不完整');\n            } else {\n                const avatar = this.avatar === 'img/default_avatar/avatar.jpg'? 'defaultAvatar.jpg':this.avatar\n                const name = this.name;\n                const sex = this.sexRadio;\n                const user = this.$parent.user;\n                if (avatar && name && sex && user) {\n                    let Data = {\n                        'avatar': avatar,\n                        'name': name,\n                        'sex': sex,\n                        'user': user\n                    };\n                    this.axios.post(api + 'uploadForm', Data, config).then(response => {\n                        if (response.data === 'success') {\n                            this.$message({\n                                message: '修改成功',\n                                type: 'success',\n                                duration: 1000\n                            })\n                        }\n                    })\n                    this.axios.post(api + 'updataInfo', {user: user}).then(response => {\n                        if (response.data) {\n                            let {name, sex, avatar} = response.data\n                            this.$parent.name = name\n                            this.$parent.sex = sex\n                            this.$parent.avatar = avatar\n                        }\n                    })\n                }\n            }\n        }\n    }\n}\n",{"version":3,"sources":["personalInfor.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"personalInfor.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n    <transition name=\"el-zoom-in-top\">\r\n\r\n        <div id=\"personalInfor\">\r\n\r\n            <div class=\"avatar\">\r\n                <el-upload\r\n                        class=\"avatar-uploader\"\r\n                        :action=\"avatarAction\"\r\n                        :show-file-list=\"false\"\r\n                        :on-success=\"handleAvatarSuccess\"\r\n                        :before-upload=\"beforeAvatarUpload\">\r\n                    <el-image  shape=\"square\" style=\"width: 100px; height: 100px\" :src=\"avatarImg\" fit=\"scale-down\"></el-image>\r\n                </el-upload>\r\n            </div>\r\n            <el-form>\r\n                <div class=\"main\">\r\n                    <div class=\"edit\">\r\n                        <el-row>\r\n                            <el-col :offset=\"4\" :span=\"3\"><span class=\"text\">昵称</span></el-col>\r\n                            <el-col :span=\"10\" class=\"name\">\r\n                                <el-form-item>\r\n                                    <el-input class=\"myInput\" v-model=\"name\"></el-input>\r\n                                </el-form-item>\r\n                            </el-col>\r\n                        </el-row>\r\n                    </div>\r\n                    <div class=\"edit\">\r\n                        <el-row>\r\n                            <el-col :offset=\"4\" :span=\"3\"><span class=\"text\">性别</span></el-col>\r\n                            <el-col :span=\"10\">\r\n                                <el-form-item>\r\n\r\n                                    <el-radio-group v-model=\"sexRadio\">\r\n                                        <el-radio-button label=\"男\"></el-radio-button>\r\n                                        <el-radio-button label=\"女\"></el-radio-button>\r\n                                    </el-radio-group>\r\n                                </el-form-item>\r\n                            </el-col>\r\n                        </el-row>\r\n                    </div>\r\n                </div>\r\n                <el-row class=\"commit\">\r\n                    <el-col>\r\n                        <el-form-item>\r\n                            <el-button type=\"success\" @click=\"commit\" :span=\"12\" icon=\"el-icon-thumb\" round>提交\r\n                            </el-button>\r\n\r\n                        </el-form-item>\r\n                    </el-col>\r\n                </el-row>\r\n            </el-form>\r\n        </div>\r\n\r\n    </transition>\r\n\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"personalInfor\",\r\n        data() {\r\n            return {\r\n                sexRadio: '',\r\n                name: '',\r\n                avatar: '',\r\n                avatarImg:'img/default_avatar/avatar.jpg',\r\n                avatarAction:'http://localhost:8888/uploadImg'\r\n            };\r\n        },\r\n        mounted() {\r\n            this.name = this.$parent.name //把个人信息填充进来\r\n            this.sexRadio = this.$parent.sex\r\n            this.avatarImg = this.$parent.avatar || 'img/default_avatar/avatar.jpg'\r\n        },\r\n        methods: {\r\n            handleAvatarSuccess(res, file) {\r\n                this.imageUrl = URL.createObjectURL(file.raw);\r\n                this.avatarImg = this.imageUrl\r\n                this.avatar = res\r\n            },\r\n            beforeAvatarUpload(file) {\r\n                const ImgType = ['image/jpeg', 'image/png', ' image/jpg'];\r\n                let isImg = ImgType.includes(file.type);\r\n                const isLt2M = file.size / 1024 / 1024 < 2;\r\n\r\n                if (!isImg) {\r\n                    this.$message.error('上传头像图片只能是 jpg/png 格式!');\r\n                }\r\n                if (!isLt2M) {\r\n                    this.$message.error('上传头像图片大小不能超过 2MB!');\r\n                }\r\n                return isImg && isLt2M;\r\n            },\r\n            commit() {\r\n                const config = {\r\n                    headers: {'Content-Type': 'application/json'}\r\n                }\r\n                const api = this.$parent.api\r\n                if (this.name === '' || this.sexRadio === '') {\r\n                    this.$message.error('信息不完整');\r\n                } else {\r\n                    const avatar = this.avatar === 'img/default_avatar/avatar.jpg'? 'defaultAvatar.jpg':this.avatar\r\n                    const name = this.name;\r\n                    const sex = this.sexRadio;\r\n                    const user = this.$parent.user;\r\n                    if (avatar && name && sex && user) {\r\n                        let Data = {\r\n                            'avatar': avatar,\r\n                            'name': name,\r\n                            'sex': sex,\r\n                            'user': user\r\n                        };\r\n                        this.axios.post(api + 'uploadForm', Data, config).then(response => {\r\n                            if (response.data === 'success') {\r\n                                this.$message({\r\n                                    message: '修改成功',\r\n                                    type: 'success',\r\n                                    duration: 1000\r\n                                })\r\n                            }\r\n                        })\r\n                        this.axios.post(api + 'updataInfo', {user: user}).then(response => {\r\n                            if (response.data) {\r\n                                let {name, sex, avatar} = response.data\r\n                                this.$parent.name = name\r\n                                this.$parent.sex = sex\r\n                                this.$parent.avatar = avatar\r\n                            }\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang=\"stylus\">\r\n    #personalInfor\r\n        .avatar\r\n            margin-top 35vw\r\n\r\n            .avatar-uploader .el-upload {\r\n                border: 1px dashed #efefef88;\r\n                border-radius: 6px;\r\n                cursor: pointer;\r\n                position: relative;\r\n                overflow: hidden;\r\n            }\r\n\r\n            .avatar-uploader .el-upload:hover {\r\n                border-color: #c6c6c6;\r\n            }\r\n\r\n            .avatar-uploader-icon {\r\n                font-size: 28px;\r\n                color: #8c939d;\r\n                width: 178px;\r\n                height: 178px;\r\n                line-height: 178px;\r\n                text-align: center;\r\n            }\r\n\r\n            .avatar {\r\n                width: 178px;\r\n                height: 178px;\r\n                display: block;\r\n            }\r\n\r\n        .main\r\n            .edit\r\n                margin-top 40px\r\n\r\n                .text\r\n                    color #ececec\r\n                    height: 50px\r\n                    line-height: 50px\r\n                    font-size: 17px\r\n\r\n                .el-input__inner\r\n                    background-color: #fff0\r\n                    border 0\r\n                    border-bottom 1px solid rgba(71, 97, 110, 0.72)\r\n                    border-radius 0\r\n                    display: inline-block\r\n                    padding-left 5px\r\n                    font-size: 17px\r\n                    height: 40px\r\n                    line-height: 40px\r\n                    width: 70%\r\n                    color #ececec\r\n\r\n                .el-radio-button__inner\r\n                    background-color: #fff8\r\n                    border 0\r\n                    outline 0\r\n\r\n        .commit\r\n            margin-top 3em\r\n</style>\r\n"]}]}